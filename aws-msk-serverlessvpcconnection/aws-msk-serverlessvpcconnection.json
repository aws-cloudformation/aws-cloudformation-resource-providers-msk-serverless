{
    "typeName": "AWS::MSK::ServerlessVpcConnection",
    "description": "Resource Type definition for AWS::MSK::ServerlessVpcConnection",
    "definitions": {
        "Authentication": {
            "type": "string",
            "description": "The type of private link authentication",
            "minLength": 3,
            "maxLength": 10,
            "enum": [
                "SASL_IAM"
            ]
        },
        "ClientSubnets": {
            "type": "array",
            "uniqueItems": false,
            "insertionOrder": false,
            "items": {
                "type": "string",
                "pattern": "^(subnet-)([a-z0-9]+)\\Z"
            }
        },
        "SecurityGroups": {
            "type": "array",
            "uniqueItems": false,
            "insertionOrder": false,
            "items": {
                "type": "string",
                "pattern": "^(sg-)([a-z0-9]+)\\Z"
            }
        },
        "Tags": {
            "type": "object",
            "description": "A key-value pair to associate with a resource.",
            "patternProperties": {
                "^([\\p{L}\\p{Z}\\p{N}_.:/=+\\-@]*)$": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "VpcId": {
            "type": "string",
            "pattern": "^(vpc-)([a-z0-9]+)\\Z"
        }
    },
    "properties": {
        "Arn": {
            "type": "string"
        },
        "Authentication": {
            "$ref": "#/definitions/Authentication"
        },
        "ClientSubnets": {
            "$ref": "#/definitions/ClientSubnets"
        },
        "TargetClusterArn": {
            "description": "The Amazon Resource Name (ARN) of the target cluster",
            "type": "string",
            "pattern": "^arn:[\\w-]+:kafka:[\\w-]+:\\d+:cluster.*\\Z"
        },
        "SecurityGroups": {
            "$ref": "#/definitions/SecurityGroups"
        },
        "Tags": {
            "$ref": "#/definitions/Tags"
        },
        "VpcId": {
            "$ref": "#/definitions/VpcId"
        }
    },
    "additionalProperties": false,
    "required": [
        "Authentication",
        "ClientSubnets",
        "SecurityGroups",
        "TargetClusterArn",
        "VpcId"
    ],
    "createOnlyProperties": [
        "/properties/ClientSubnets",
        "/properties/Authentication",
        "/properties/SecurityGroups",
        "/properties/TargetClusterArn",
        "/properties/VpcId"
    ],
    "readOnlyProperties": [
        "/properties/Arn"
    ],
    "primaryIdentifier": [
        "/properties/Arn"
    ],
    "tagging": {
        "taggable": true,
        "tagOnCreate": true,
        "tagUpdatable": true,
        "cloudFormationSystemTags": true,
        "tagProperty": "/properties/Tags"
    },
    "handlers": {
        "create": {
            "permissions": [
                "ec2:CreateVpcEndpoint",
                "ec2:DescribeSecurityGroups",
                "ec2:DescribeSubnets",
                "ec2:DescribeVpcAttribute",
                "ec2:DescribeVpcs",
                "ec2:DescribeVpcEndpoints",
                "ec2:DescribeVpcEndpointConnections",
                "ec2:CreateTags",
                "iam:AttachRolePolicy",
                "iam:CreateServiceLinkedRole",
                "iam:PutRolePolicy",
                "kafka:CreateVpcConnection",
                "kafka:DescribeVpcConnection",
                "kafka:TagResource"
            ]
        },
        "read": {
            "permissions": [
                "kafka:DescribeVpcConnection"
            ]
        },
        "update": {
            "permissions": [
                "kafka:DescribeVpcConnection",
                "kafka:TagResource",
                "kafka:UntagResource"
            ]
        },
        "delete": {
            "permissions": [
                "ec2:DeleteVpcEndpoint",
                "ec2:DeleteVpcEndpoints",
                "ec2:DescribeVpcEndpoints",
                "ec2:DescribeVpcEndpointConnections",
                "kafka:DeleteVpcConnection",
                "kafka:DescribeVpcConnection"
            ]
        },
        "list": {
            "permissions": [
                "kafka:ListVpcConnections"
            ]
        }
    }
}

